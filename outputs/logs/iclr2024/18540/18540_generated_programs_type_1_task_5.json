{
    "source": [
        "/workspace/scripts/ppo-lag.sh",
        "/workspace/scripts/ppo-reward-shaping.sh",
        "/workspace/scripts/arena-evaluation.sh"
    ],
    "usage_instructions": "To compare the integrated Cost Model with safety classifier logits, follow these steps:\n\n1. First, ensure you have trained the necessary prerequisite models:\n   - SFT model: Run `scripts/sft.sh --model_name_or_path <base_model> --output_dir output/sft`\n   - Reward model: Run `scripts/reward-model.sh --model_name_or_path output/sft --output_dir output/rm`\n   - Cost model: Run `scripts/cost-model.sh --model_name_or_path output/sft --output_dir output/cm`\n\n2. Train the integrated Cost Model with Lagrange multiplier (Safe RLHF):\n   ```\n   scripts/ppo-lag.sh \\\n       --actor_model_name_or_path output/sft \\\n       --reward_model_name_or_path output/rm \\\n       --cost_model_name_or_path output/cm \\\n       --output_dir output/ppo-lag\n   ```\n\n3. Train the model using safety classifier logits directly (without Lagrange multiplier):\n   ```\n   scripts/ppo-reward-shaping.sh \\\n       --actor_model_name_or_path output/sft \\\n       --reward_model_name_or_path output/rm \\\n       --cost_model_name_or_path output/cm \\\n       --output_dir output/ppo-reward-shaping\n   ```\n\n4. Compare the two models using arena evaluation:\n   ```\n   scripts/arena-evaluation.sh \\\n       --red_corner_model_name_or_path output/ppo-reward-shaping \\\n       --blue_corner_model_name_or_path output/ppo-lag \\\n       --reward_model_name_or_path output/rm \\\n       --cost_model_name_or_path output/cm \\\n       --output_dir output/arena-evaluation\n   ```\n\nThis will evaluate both models on the same test set and provide metrics on harmfulness (cost scores) and helpfulness (reward scores), allowing you to compare the effectiveness of the integrated Cost Model with Lagrange multiplier versus using safety classifier logits directly."
}
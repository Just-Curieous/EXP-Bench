{
    "source": [
        "/workspace/OpenPDE/SineNet/pdearena/scripts/train.py",
        "/workspace/OpenPDE/SineNet/pdearena/scripts/test.py"
    ],
    "usage_instructions": "To compare SineNet-8 with circular padding vs. zero padding on the SWE dataset:\n\n1. First, train the SineNet-8 model with zero padding:\n   ```\n   cd /workspace/OpenPDE/SineNet/pdearena\n   source setup.sh\n   python scripts/train.py -c configs/shallowwater2d_2day.yaml \\\n       --data.data_dir=<path_to_SWE_data> \\\n       --data.num_workers=8 \\\n       --data.batch_size=32 \\\n       --model.name=sinenet8-dual \\\n       --model.lr=2e-4 --optimizer.lr=2e-4\n   ```\n\n2. Then, train the SineNet-8 model with circular padding:\n   ```\n   python scripts/train.py -c configs/shallowwater2d_2day.yaml \\\n       --data.data_dir=<path_to_SWE_data> \\\n       --data.num_workers=8 \\\n       --data.batch_size=32 \\\n       --model.name=sinenet8-dual-circ \\\n       --model.lr=2e-4 --optimizer.lr=2e-4\n   ```\n\n3. The training script automatically runs testing after training completes. The test results will include both one-step and rollout error percentages as described in Table 3 of the paper. The metrics will be logged to TensorBoard and can be found in the output directory.\n\n4. To manually test the models and compare their performance:\n   ```\n   python scripts/test.py test -c configs/shallowwater2d_2day.yaml \\\n       --data.data_dir=<path_to_SWE_data> \\\n       --trainer.devices=1 \\\n       --data.num_workers=8 \\\n       --data.batch_size=32 \\\n       --model.name=sinenet8-dual \\\n       --ckpt_path=<path_to_zero_padding_checkpoint>\n   ```\n\n   And for the circular padding model:\n   ```\n   python scripts/test.py test -c configs/shallowwater2d_2day.yaml \\\n       --data.data_dir=<path_to_SWE_data> \\\n       --trainer.devices=1 \\\n       --data.num_workers=8 \\\n       --data.batch_size=32 \\\n       --model.name=sinenet8-dual-circ \\\n       --ckpt_path=<path_to_circular_padding_checkpoint>\n   ```\n\n5. The test results will include metrics for both one-step prediction errors and rollout errors, which can be compared between the two models to assess the impact of padding method on the modeling of advection across boundaries."
}
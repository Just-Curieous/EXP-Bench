{
    "source": [
        "/workspace/tests/TestGES.py",
        "/workspace/causallearn/graph/SHD.py"
    ],
    "usage_instructions": "To compare standard score functions with generalized score functions for causal discovery using GES:\n\n1. Modify TestGES.py to create a new test method that runs GES with both standard and generalized score functions on the same datasets.\n2. For standard score functions, use 'local_score_BIC' (already implemented in test_ges_load_linear_10_with_local_score_BIC) or 'local_score_BDeu' (already implemented in test_ges_load_discrete_10_with_local_score_BDeu).\n3. For generalized score functions, add a new test using 'local_score_cv_general' or 'local_score_marginal_general' with the same datasets.\n4. Use the SHD.py module to calculate the Structural Hamming Distance between the recovered graphs and the ground truth.\n5. Compare the SHD values to determine which score function performs better in recovering the causal structure.\n\nExample modification to TestGES.py:\n```python\ndef test_ges_compare_standard_vs_generalized_score(self):\n    print('Now comparing standard vs generalized score functions...')\n    data_path = \"tests/TestData/data_linear_10.txt\"\n    truth_graph_path = \"tests/TestData/graph.10.txt\"\n    data = np.loadtxt(data_path, skiprows=1)\n    truth_dag = txt2generalgraph(truth_graph_path)\n    truth_cpdag = dag2cpdag(truth_dag)\n    \n    # Run GES with standard score (BIC)\n    res_standard = ges(data, score_func='local_score_BIC', maxP=None, parameters=None)\n    \n    # Run GES with generalized score (CV general)\n    parameters = {\n        \"kfold\": 10,  # 10 fold cross validation\n        \"lambda\": 0.01,  # regularization parameter\n    }\n    res_generalized = ges(data, score_func='local_score_cv_general', maxP=None, parameters=parameters)\n    \n    # Calculate SHD for both methods\n    shd_standard = SHD(truth_cpdag, res_standard['G'])\n    shd_generalized = SHD(truth_cpdag, res_generalized['G'])\n    \n    print(f\"Standard score (BIC) SHD: {shd_standard.get_shd()}\")\n    print(f\"Generalized score (CV) SHD: {shd_generalized.get_shd()}\")\n    \n    # Compare results\n    if shd_generalized.get_shd() < shd_standard.get_shd():\n        print(\"Generalized score function performs better in recovering the causal structure\")\n    else:\n        print(\"Standard score function performs better in recovering the causal structure\")\n```"
}